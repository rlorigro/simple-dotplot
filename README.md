# simple-dotplot
Very simple and configurable all-in-one dotplot program. Only very basic system dependencies such as build tools are required. Create a dotplot directly from a pair of FASTA/FASTQ files without having to run nucmer or any other alignment manually. Alternatively, if you have a PAF already (from a mapper such as minimap2), make a simple dot plot using that.

## Installation

```
git clone https://github.com/rlorigro/simple-dotplot.git
cd simple-dotplot
mkdir build
cd build
cmake ..
make -j [n_threads]
```

The executable is created in the `build` directory.

Tested on macOS 11.1 and ubuntu 20.04

## Dependencies

You may need to install the following libraries to compile (all contained within the `build-essentials` package on ubuntu):

```
GCC compiler (g++ version >= 4.7)
CMake >= v3.10
C++17
```

## Usage 

```
Usage: ./dotplot [OPTIONS]

Options:
  -h,--help                   Print this help message and exit
  -r,--ref TEXT REQUIRED      Path to FASTA/Q of ref sequences
  -q,--query TEXT REQUIRED    Path to FASTA/Q of query sequences
  -l,--min_length INT REQUIRED
                              Minimum length of match to be considered
  --mask_diagonal             Whether to zero all diagonal entries. 
                              Useful for self-dotplots, which have an extreme outlier on the diagonal
  -o,--output_dir TEXT REQUIRED
                              Path of directory to save output
```

Example:
```
./dotplot \
--ref /home/ryan/data/test/1.chm13.cenX.fasta \
--query /home/ryan/data/test/1.chm13.cenX.fasta \
--min_length 1024 \
--output_dir /home/ryan/data/test/test_simple_dotplot_mask_1024/ \
--mask_diagonal
```

## Example output

The following plots were generated by comparing the T2T chrX centromere to itself:

With `min_length=1024` (runtime: 0m 1s)
![image](https://user-images.githubusercontent.com/28764332/124673796-5fcd7000-de6e-11eb-925d-c091b0e497ff.png)

With `min_length=16` (runtime: 7m 48s)
![image](https://user-images.githubusercontent.com/28764332/124677724-e89bda00-de75-11eb-9e4e-3abb2b462ce9.png)


## Limitations

1. The directionality of your contigs must be set manually. The program will not try to search both the F and R complements.
2. At the moment there is no option to use MUMs instead of MEMs.

If these or any other limitations are causing you problems, please open an issue and I will update the repo when I get the chance.
